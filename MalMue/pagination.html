{% macro pagination(page, max_pages) %}
<nav>
    <ul class="pagination justify-content-center">

    {% if page > 1 %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('library',page=page-1) }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">Previous</span>
            </a>
        </li>
    {% endif %}

    {% if page-3 >= 1 %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('library',page=1) }}">1</a>
        </li>
        <li class="page-item"><a class="page-link">...</a></li>
    {% endif %}

    {% if page-2 >= 1 %}
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page-2) }}">{{ page-2 }}</a></li>
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page-1) }}">{{ page-1 }}</a></li>
    {% elif page-1 >= 1 %}
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page-1) }}">{{ page-1 }}</a></li>
    {% endif %}

    <li class="page-item active"><a class="page-link" href="{{ url_for('library',page=page) }}">{{ page }}</a></li>

    {% if page+2 <= max_pages %}
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page+1) }}">{{ page+1 }}</a></li>
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page+3) }}">{{ page+2 }}</a></li>
    {% elif page+1 <= max_pages %}
        <li class="page-item"><a class="page-link" href="{{ url_for('library',page=page+1) }}">{{ page+1 }}</a></li>
    {% endif %}

    {% if page+3 < max_pages %}
        <li class="page-item"><a class="page-link">...</a></li>
        <li class="page-item">
            <a class="page-link" href="{{ url_for('library',page=max_pages) }}">{{ max_pages }}</a>
        </li>
    {% endif %}

    {% if page < max_pages %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('library',page=page+1) }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
            </a>
        </li>
    {% endif %}
    </ul>
</nav>
{% endmacro %}